{% extends 'usuarios/base.html' %}

{% block title %}Cadastrar Dependente - Cadastro de Pessoas{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-9">
            <div class="card">
                <div class="card-body p-5">
                    <div class="text-center mb-4">
                        <div class="display-4 text-primary mb-3">
                            <i class="bi bi-person-plus"></i>
                        </div>
                        <h2 class="fw-bold">Cadastrar Dependente</h2>
                        <p class="text-muted">Preencha os dados do dependente</p>
                    </div>
                    
                    <form id="dependente-form"  method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        
                        <!-- Dados Pessoais -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="bi bi-person me-2"></i>
                                    Dados Pessoais
                                </h5>
                            </div>
                            
                            <div class="col-12 mb-3">
                                <label for="{{ form.nome_completo.id_for_label }}" class="form-label fw-bold">
                                    Nome Completo
                                </label>
                                {{ form.nome_completo }}
                                {% if form.nome_completo.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.nome_completo.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.data_nascimento.id_for_label }}" class="form-label fw-bold">
                                    Data de Nascimento
                                </label>
                                {{ form.data_nascimento }}
                                {% if form.data_nascimento.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.data_nascimento.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <small class="text-muted">Dependente deve ter entre 6 e 18 anos</small>
                            </div>

                             <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.cpf.id_for_label }}" class="form-label fw-bold">
                                    <i class="bi bi-card-text me-1"></i>
                                    CPF
                                </label>
                                {{ form.cpf }}
                                {% if form.cpf.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.cpf.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.parentesco.id_for_label }}" class="form-label fw-bold">
                                    Parentesco
                                </label>
                                {{ form.parentesco }}
                                {% if form.parentesco.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.parentesco.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-12 mb-3">
                                <label for="{{ form.foto.id_for_label }}" class="form-label fw-bold">
                                    <i class="bi bi-camera me-1"></i>
                                    Foto do Dependente
                                </label>
                                {{ form.foto }}
                                {% if form.foto.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.foto.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <small class="text-muted">{{ form.foto.help_text }}</small>
                            </div>
                        </div>
                        
                        <!-- Endereço -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="bi bi-geo-alt me-2"></i>
                                    Endereço
                                </h5>
                            </div>
                            
                            <div class="col-md-4 mb-3">
                                <label for="{{ form.cep.id_for_label }}" class="form-label fw-bold">
                                    CEP
                                </label>
                                {{ form.cep }}
                                {% if form.cep.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.cep.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <small class="text-muted">Preenchimento automático</small>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.logradouro.id_for_label }}" class="form-label fw-bold">
                                    Logradouro
                                </label>
                                {{ form.logradouro }}
                                {% if form.logradouro.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.logradouro.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-2 mb-3">
                                <label for="{{ form.numero.id_for_label }}" class="form-label fw-bold">
                                    Número
                                </label>
                                {{ form.numero }}
                                {% if form.numero.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.numero.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.complemento.id_for_label }}" class="form-label fw-bold">
                                    Complemento
                                </label>
                                {{ form.complemento }}
                                {% if form.complemento.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.complemento.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-4 mb-3">
                                <label for="{{ form.bairro.id_for_label }}" class="form-label fw-bold">
                                    Bairro
                                </label>
                                {{ form.bairro }}
                                {% if form.bairro.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.bairro.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-2 mb-3">
                                <label for="{{ form.uf.id_for_label }}" class="form-label fw-bold">
                                    UF
                                </label>
                                {{ form.uf }}
                                {% if form.uf.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.uf.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.cidade.id_for_label }}" class="form-label fw-bold">
                                    Cidade
                                </label>
                                {{ form.cidade }}
                                {% if form.cidade.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.cidade.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- Dados Escolares -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="bi bi-mortarboard me-2"></i>
                                    Dados Escolares
                                </h5>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.escolaridade.id_for_label }}" class="form-label fw-bold">
                                    Escolaridade
                                </label>
                                {{ form.escolaridade }}
                                {% if form.escolaridade.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.escolaridade.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.escola.id_for_label }}" class="form-label fw-bold">
                                    Escola
                                </label>
                                {{ form.escola }}
                                {% if form.escola.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.escola.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.turno.id_for_label }}" class="form-label fw-bold">
                                    Turno
                                </label>
                                {{ form.turno }}
                                {% if form.turno.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.turno.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- Dados de Matrícula -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="bi bi-card-checklist me-2"></i>
                                    Dados de Matrícula
                                </h5>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.tipo_matricula.id_for_label }}" class="form-label fw-bold">
                                    <i class="bi bi-list-check me-1"></i>
                                    Tipo de Matrícula
                                </label>
                                {{ form.tipo_matricula }}
                                {% if form.tipo_matricula.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.tipo_matricula.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <small class="text-muted">{{ form.tipo_matricula.help_text }}</small>
                            </div>
                            
                            <div class="col-md-6 mb-3" id="modalidade-field" style="display: none;">
                                <label for="{{ form.modalidade.id_for_label }}" class="form-label fw-bold">
                                    <i class="bi bi-trophy me-1"></i>
                                    Modalidade
                                </label>
                                {{ form.modalidade }}
                                {% if form.modalidade.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.modalidade.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                <small class="text-muted">{{ form.modalidade.help_text }}</small>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.status_matricula.id_for_label }}" class="form-label fw-bold">
                                    <i class="bi bi-info-circle me-1"></i>
                                    Status da Matrícula
                                </label>
                                {{ form.status_matricula }}
                                {% if form.status_matricula.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.status_matricula.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- Condições Médicas -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="bi bi-heart-pulse me-2"></i>
                                    Condições Médicas
                                </h5>
                            </div>
                            
                            <div class="col-12 mb-3">
                                <label for="{{ form.condicoes_medicas.id_for_label }}" class="form-label fw-bold">
                                    Condições Médicas para Prática de Esportes
                                </label>
                                {{ form.condicoes_medicas }}
                                {% if form.condicoes_medicas.errors %}
                                    <div class="text-danger small mt-1">
                                        {% for error in form.condicoes_medicas.errors %}
                                            <div>{{ error }}</div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <!-- Termos -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h5 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="bi bi-file-text me-2"></i>
                                    Termos e Condições
                                </h5>
                            </div>
                            
                            <div class="col-12 mb-3">
                                <div class="form-check">
                                    {{ form.termo_responsabilidade }}
                                    <label class="form-check-label fw-bold" for="{{ form.termo_responsabilidade.id_for_label }}">
                                        Aceito os Termos de Responsabilidade
                                    </label>
                                    {% if form.termo_responsabilidade.errors %}
                                        <div class="text-danger small mt-1">
                                            {% for error in form.termo_responsabilidade.errors %}
                                                <div>{{ error }}</div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                                <small class="text-muted">
                                    Declaro que sou responsável pelo dependente e autorizo sua participação nas atividades.
                                </small>
                            </div>
                            
                            <div class="col-12 mb-3">
                                <div class="form-check">
                                    {{ form.termo_uso_imagem }}
                                    <label class="form-check-label fw-bold" for="{{ form.termo_uso_imagem.id_for_label }}">
                                        Autorizo o Uso de Imagem
                                    </label>
                                    {% if form.termo_uso_imagem.errors %}
                                        <div class="text-danger small mt-1">
                                            {% for error in form.termo_uso_imagem.errors %}
                                                <div>{{ error }}</div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                                <small class="text-muted">
                                    Autorizo o uso da imagem do dependente para fins institucionais e de divulgação.
                                </small>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex gap-3">
                                    <button type="submit" id="btn-submit"  class="btn btn-primary btn-lg">
                                        <i class="bi bi-person-plus me-2"></i>
                                        Cadastrar Dependente
                                    </button>
                                    <a href="{% url 'home' %}" class="btn btn-outline-secondary btn-lg">
                                        <i class="bi bi-arrow-left me-2"></i>
                                        Voltar
                                    </a>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tipoMatriculaField = document.getElementById('id_tipo_matricula');
    const modalidadeField = document.getElementById('modalidade-field');
    
    function toggleModalidadeField() {
        const selectedOption = tipoMatriculaField.options[tipoMatriculaField.selectedIndex];
        const isModalidadePaga = selectedOption && selectedOption.text.includes('Modalidade Paga');
        
        if (isModalidadePaga) {
            modalidadeField.style.display = 'block';
            modalidadeField.querySelector('select').required = true;
        } else {
            modalidadeField.style.display = 'none';
            modalidadeField.querySelector('select').required = false;
            modalidadeField.querySelector('select').value = '';
        }
    }
    
    // Executar na carga inicial
    toggleModalidadeField();
    
    // Executar quando o tipo de matrícula mudar
    tipoMatriculaField.addEventListener('change', toggleModalidadeField);
});
</script>

{% endblock %}

