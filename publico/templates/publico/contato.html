{% extends 'publico/base.html' %}
{% load static %}

{% block title %}Contato - Dojô Uemura{% endblock %}

{% block extra_css %}
<style>
    .contato-hero {
        background: linear-gradient(135deg, var(--primary-red) 0%, var(--japanese-navy) 100%);
        color: white;
        padding: 100px 0 80px;
        margin-top: -80px;
    }
    
    .contato-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        padding: 2rem;
        margin-bottom: 2rem;
        transition: transform 0.3s ease;
    }
    
    .contato-card:hover {
        transform: translateY(-5px);
    }
    
    .contato-icon {
        width: 60px;
        height: 60px;
        background: var(--primary-red);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        color: white;
        font-size: 1.5rem;
    }
    
    .horarios-table {
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .horarios-table th {
        background: var(--japanese-navy);
        color: white;
        border: none;
        padding: 1rem;
    }
    
    .horarios-table td {
        padding: 1rem;
        border-bottom: 1px solid #eee;
    }
    
    .horarios-table tr:last-child td {
        border-bottom: none;
    }
    
    .formulario-contato {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        padding: 2rem;
    }
    
    .form-control {
        border-radius: 10px;
        border: 2px solid #eee;
        padding: 0.75rem 1rem;
        transition: all 0.3s ease;
    }
    
    .form-control:focus {
        border-color: var(--primary-red);
        box-shadow: 0 0 0 0.2rem rgba(255, 44, 0, 0.25);
    }
    
    .btn-contato {
        background: var(--primary-red);
        border: none;
        border-radius: 10px;
        padding: 0.75rem 2rem;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    
    .btn-contato:hover {
        background: #e02600;
        transform: translateY(-2px);
    }
    
    .mapa-container {
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    
    .redes-sociais a {
        display: inline-block;
        width: 50px;
        height: 50px;
        background: var(--primary-red);
        color: white;
        border-radius: 50%;
        text-align: center;
        line-height: 50px;
        margin: 0 10px;
        transition: all 0.3s ease;
        text-decoration: none;
    }
    
    .redes-sociais a:hover {
        background: var(--japanese-navy);
        transform: translateY(-3px);
    }
</style>
{% endblock %}

{% block content %}
<!-- ===== HERO SECTION ===== -->
<section class="contato-hero">
    <div class="container text-center">
        <h1 class="display-4 fw-bold mb-4">Entre em Contato</h1>
        <p class="lead mb-0">Estamos aqui para ajudar! Entre em contato conosco para mais informações.</p>
    </div>
</section>

    <!-- ===== INFORMAÇÕES DE CONTATO ===== -->
    <section class="py-5">
        <div class="container">
            <!-- Mensagens de feedback -->
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show mb-4" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        <div class="row">
            <!-- Informações Principais -->
            <div class="col-lg-8">
                <div class="row">
                    <!-- Telefone -->
                    <div class="col-md-6 mb-4">
                        <div class="contato-card text-center h-100">
                            <div class="contato-icon">
                                <i class="bi bi-telephone"></i>
                            </div>
                            <h5>Telefone</h5>
                            {% if empresa_info %}
                                {% for telefone in empresa_info.get_telefones %}
                                    <p class="text-muted mb-1">{{ telefone }}</p>
                                {% endfor %}
                            {% else %}
                                <p class="text-muted mb-1">(65) 99999-9999</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Email -->
                    <div class="col-md-6 mb-4">
                        <div class="contato-card text-center h-100">
                            <div class="contato-icon">
                                <i class="bi bi-envelope"></i>
                            </div>
                            <h5>Email</h5>
                            {% if empresa_info %}
                                <p class="text-muted mb-0">{{ empresa_info.email }}</p>
                            {% else %}
                                <p class="text-muted mb-0">contato@dojouemura.com</p>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Endereço -->
                    <div class="col-md-12 mb-4">
                        <div class="contato-card text-center h-100">
                            <div class="contato-icon">
                                <i class="bi bi-geo-alt"></i>
                            </div>
                            <h5>Endereço</h5>
                            {% if empresa_info %}
                                <p class="text-muted mb-0">{{ empresa_info.get_endereco_completo }}</p>
                            {% else %}
                                <p class="text-muted mb-0">Chapada dos Guimarães, MT</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- Horários de Funcionamento -->
                {% if empresa_info %}
                <div class="contato-card">
                    <h4 class="text-primary mb-4">
                        <i class="bi bi-clock me-2"></i>Horários de Funcionamento
                    </h4>
                    <div class="table-responsive">
                        <table class="table horarios-table">
                            <thead>
                                <tr>
                                    <th>Dia da Semana</th>
                                    <th>Horário</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Segunda-feira</strong></td>
                                    <td>{{ empresa_info.segunda_feira }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Terça-feira</strong></td>
                                    <td>{{ empresa_info.terca_feira }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Quarta-feira</strong></td>
                                    <td>{{ empresa_info.quarta_feira }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Quinta-feira</strong></td>
                                    <td>{{ empresa_info.quinta_feira }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Sexta-feira</strong></td>
                                    <td>{{ empresa_info.sexta_feira }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Sábado</strong></td>
                                    <td>{{ empresa_info.sabado }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Domingo</strong></td>
                                    <td>{{ empresa_info.domingo }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                {% endif %}
                
                <!-- Redes Sociais -->
                {% if empresa_info %}
                <div class="contato-card text-center">
                    <h4 class="text-primary mb-4">
                        <i class="bi bi-share me-2"></i>Siga-nos nas Redes Sociais
                    </h4>
                    <div class="redes-sociais">
                        {% if empresa_info.instagram %}
                            <a href="{{ empresa_info.instagram }}" target="_blank" title="Instagram">
                                <i class="bi bi-instagram"></i>
                            </a>
                        {% endif %}
                        {% if empresa_info.facebook %}
                            <a href="{{ empresa_info.facebook }}" target="_blank" title="Facebook">
                                <i class="bi bi-facebook"></i>
                            </a>
                        {% endif %}
                        {% if empresa_info.youtube %}
                            <a href="{{ empresa_info.youtube }}" target="_blank" title="YouTube">
                                <i class="bi bi-youtube"></i>
                            </a>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
            
            <!-- Formulário de Contato -->
            <div class="col-lg-4">
                <div class="formulario-contato">
                    <h4 class="text-primary mb-4">
                        <i class="bi bi-chat-dots me-2"></i>Envie uma Mensagem
                    </h4>
                    <form method="post">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="nome" class="form-label">Nome Completo *</label>
                            <input type="text" class="form-control" id="nome" name="nome" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email *</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="telefone" class="form-label">Telefone</label>
                            <input type="tel" class="form-control" id="telefone" name="telefone">
                        </div>
                        <div class="mb-3">
                            <label for="assunto" class="form-label">Assunto *</label>
                            <select class="form-control" id="assunto" name="assunto" required>
                                <option value="">Selecione um assunto</option>
                                <option value="matricula">Matrícula</option>
                                <option value="projeto_social">Projeto Social</option>
                                <option value="horarios">Horários</option>
                                <option value="precos">Preços</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label for="mensagem" class="form-label">Mensagem *</label>
                            <textarea class="form-control" id="mensagem" name="mensagem" rows="4" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-contato btn-lg w-100">
                            <i class="bi bi-send me-2"></i>Enviar Mensagem
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ===== MAPA ===== -->
{% if empresa_info %}
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-6 fw-bold text-primary">Nossa Localização</h2>
            <p class="lead text-muted">Venha nos visitar e conhecer nossa estrutura!</p>
        </div>
        <div class="mapa-container">
            <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3888.1234567890123!2d-55.74845678901234!3d-15.456789012345678!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTXCsDI3JzI0LjQiUyA1NcKwNDQnNTQuNCJX!5e0!3m2!1spt-BR!2sbr!4v1234567890123!5m2!1spt-BR!2sbr" 
                width="100%" 
                height="450" 
                style="border:0;" 
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
    // Máscara para telefone
    document.getElementById('telefone').addEventListener('input', function (e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length > 0) {
            if (value.length <= 2) {
                value = `(${value}`;
            } else if (value.length <= 6) {
                value = `(${value.slice(0, 2)}) ${value.slice(2)}`;
            } else if (value.length <= 10) {
                value = `(${value.slice(0, 2)}) ${value.slice(2, 6)}-${value.slice(6)}`;
            } else {
                value = `(${value.slice(0, 2)}) ${value.slice(2, 7)}-${value.slice(7, 11)}`;
            }
        }
        e.target.value = value;
    });
    
    // Validação do formulário
    document.querySelector('form').addEventListener('submit', function(e) {
        const nome = document.getElementById('nome').value.trim();
        const email = document.getElementById('email').value.trim();
        const assunto = document.getElementById('assunto').value;
        const mensagem = document.getElementById('mensagem').value.trim();
        
        if (!nome || !email || !assunto || !mensagem) {
            e.preventDefault();
            alert('Por favor, preencha todos os campos obrigatórios.');
            return false;
        }
        
        if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
            e.preventDefault();
            alert('Por favor, insira um email válido.');
            return false;
        }
    });
</script>
{% endblock %}
